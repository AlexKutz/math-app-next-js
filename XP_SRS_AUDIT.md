# –ê—É–¥–∏—Ç —Å–∏—Å—Ç–µ–º—ã XP –∏ SRS

## ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ:

### 1. –°–∏—Å—Ç–µ–º–∞ —É—Å—Ç–∞–ª–æ—Å—Ç–∏ (Diminishing Returns) ‚úÖ
- **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ**: `computeDailyMultiplier` –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤—ã—á–∏—Å–ª—è–µ—Ç –º–Ω–æ–∂–∏—Ç–µ–ª–∏:
  - –ü–µ—Ä–≤—ã–µ `dailyFullTasks` (10) –∑–∞–¥–∞—á: `multiplierFull` (1.0) = 100% XP
  - –°–ª–µ–¥—É—é—â–∏–µ `dailyHalfTasks` (10) –∑–∞–¥–∞—á: `multiplierHalf` (0.5) = 50% XP
  - –û—Å—Ç–∞–ª—å–Ω—ã–µ: `multiplierLow` (0.1) = 10% XP
- **–†–∞–±–æ—Ç–∞–µ—Ç**: ‚úÖ

### 2. –°–±—Ä–æ—Å —Å—á–µ—Ç—á–∏–∫–∞ –ø—Ä–∏ "–≥–æ—Ä—è—á–µ–π —Ç–µ–º–µ" ‚úÖ
- **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ**: –ö–æ–≥–¥–∞ —Ç–µ–º–∞ "–≥–æ—Ä—è—á–∞—è" (isHotTopic), —Å—á–µ—Ç—á–∏–∫ `dailyTasksCountBefore` —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –≤ 0
- **–†–∞–±–æ—Ç–∞–µ—Ç**: ‚úÖ

### 3. –°–∏—Å—Ç–µ–º–∞ —É—Ä–æ–≤–Ω–µ–π –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–∞ ‚úÖ
- **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ**: 5 —É—Ä–æ–≤–Ω–µ–π —Å –ø–æ—Ä–æ–≥–∞–º–∏ [1000, 2500, 4500, 7000, 10000] XP
- **–†–∞–±–æ—Ç–∞–µ—Ç**: ‚úÖ `computeLevelFromThresholds` –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤—ã—á–∏—Å–ª—è–µ—Ç —É—Ä–æ–≤–µ–Ω—å

### 4. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö ‚úÖ
- **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ**: –í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ–ª—è –≤ `UserTopicXp`:
  - `dailyTasksCount`, `dailyTasksDate` - –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –¥–Ω–µ–≤–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
  - `srsStage`, `nextReviewDate` - –¥–ª—è SRS
  - `currentXp`, `level` - –¥–ª—è —É—Ä–æ–≤–Ω–µ–π
- **–†–∞–±–æ—Ç–∞–µ—Ç**: ‚úÖ

## ‚ö†Ô∏è –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

### 1. –ü—Ä–æ–±–ª–µ–º–∞ —Å –ª–æ–≥–∏–∫–æ–π SRS stage –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –∑–∞–¥–∞—á–µ
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: `lib/xp/xpService.ts:198`

**–ü—Ä–æ–±–ª–µ–º–∞**: 
- –ü—Ä–∏ –ø–µ—Ä–≤–æ–π –∑–∞–¥–∞—á–µ (srsStage = 0, nextReviewDate = null):
  - `isHotTopic = true` ‚úÖ
  - `isTooEarly = false` ‚úÖ
  - `stageAfter = 0 + 1 = 1` ‚úÖ
  - `nextReviewDate = intervals[1-1] = intervals[0] = 1 –¥–µ–Ω—å` ‚úÖ
- **–ù–û**: –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–µ—à–∞–µ—Ç –∑–∞–¥–∞—á–∏ –≤ —Ç–æ—Ç –∂–µ –¥–µ–Ω—å, –∫–æ–≥–¥–∞ —Ç–µ–º–∞ "–≥–æ—Ä—è—á–∞—è", —Å—á–µ—Ç—á–∏–∫ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è, –Ω–æ —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º–æ–π, –µ—Å–ª–∏ –æ–Ω —É–∂–µ —Ä–µ—à–∏–ª –∑–∞–¥–∞—á–∏ —Å–µ–≥–æ–¥–Ω—è —É—Ç—Ä–æ–º, –∞ —Ç–µ–º–∞ —Å—Ç–∞–ª–∞ "–≥–æ—Ä—è—á–µ–π" –≤–µ—á–µ—Ä–æ–º.

**–†–µ—à–µ–Ω–∏–µ**: –õ–æ–≥–∏–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è, –Ω–æ –Ω—É–∂–Ω–æ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Å—á–µ—Ç—á–∏–∫ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –Ω–∞ –Ω–æ–≤—ã–π –¥–µ–Ω—å –∏–ª–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º —Ä–µ—à–µ–Ω–∏–∏ –∑–∞–¥–∞—á–∏ –≤ "–≥–æ—Ä—è—á–µ–π" —Ç–µ–º–µ.

### 2. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ UI ‚ùå
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: `components/tasks/Tasks.tsx`

**–ü—Ä–æ–±–ª–µ–º–∞**: 
- –í `xpResult` –µ—Å—Ç—å –ø–æ–ª—è `isHotTopic`, `isTooEarly`, `multiplier`, `dailyTaskIndex`, –Ω–æ –æ–Ω–∏ –ù–ï –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ UI
- –ù–µ—Ç –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏:
  - ‚ùå –ë–∞—Ç–∞—Ä–µ–π–∫–∞/—ç–Ω–µ—Ä–≥–∏—è —Ç–µ–º—ã
  - ‚ùå –¢–∞–π–º–µ—Ä –¥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–ª–Ω–æ–≥–æ –æ–ø—ã—Ç–∞
  - ‚ùå –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä "–≥–æ—Ä—è—á–µ–π —Ç–µ–º—ã" (–∑–æ–ª–æ—Ç–∞—è –ø–æ–¥—Å–≤–µ—Ç–∫–∞)
  - ‚ùå Streak (—Å–µ—Ä–∏—è –¥–Ω–µ–π)

**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å –≤–∏–∑—É–∞–ª—å–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –≤ UI.

### 3. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å–ø–∏—Å–∫–∞ —Ç–µ–º ‚ùå
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: `app/(main)/math/page.tsx`

**–ü—Ä–æ–±–ª–µ–º–∞**: 
- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
  - ‚ùå –°—Ç–∞—Ç—É—Å SRS (–∫–æ–≥–¥–∞ —Å–ª–µ–¥—É—é—â–µ–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ)
  - ‚ùå –≠–Ω–µ—Ä–≥–∏—é —Ç–µ–º—ã (—Å–∫–æ–ª—å–∫–æ –∑–∞–¥–∞—á –º–æ–∂–Ω–æ —Ä–µ—à–∏—Ç—å —Å –ø–æ–ª–Ω—ã–º XP)
  - ‚ùå –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä "–≥–æ—Ä—è—á–µ–π —Ç–µ–º—ã"

**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å –≤–∏–∑—É–∞–ª—å–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å–ø–∏—Å–∫–∞ —Ç–µ–º.

### 4. –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —Å nextReviewDate –ø—Ä–∏ stageAfter = 0
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: `lib/xp/xpService.ts:200-205`

**–ü—Ä–æ–±–ª–µ–º–∞**: 
- –£—Å–ª–æ–≤–∏–µ `stageAfter <= 0` –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è, —Ç–∞–∫ –∫–∞–∫ `stageAfter` –º–∏–Ω–∏–º—É–º 1 (–µ—Å–ª–∏ `isTooEarly = false`)
- –ù–æ —ç—Ç–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ, —Ç–∞–∫ –∫–∞–∫ –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ

**–†–µ—à–µ–Ω–∏–µ**: –ú–æ–∂–Ω–æ —É–ø—Ä–æ—Å—Ç–∏—Ç—å —É—Å–ª–æ–≤–∏–µ, —É–±—Ä–∞–≤ –ø—Ä–æ–≤–µ—Ä–∫—É `stageAfter <= 0`.

### 5. –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è multiplierEarly –ø—Ä–∞–≤–∏–ª—å–Ω–æ
**–ü—Ä–æ–±–ª–µ–º–∞**: 
- –ö–æ–≥–¥–∞ `isTooEarly = true`, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `multiplierEarly` (0.1)
- –ù–æ —ç—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ –ª–æ–≥–∏–∫–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞

## üìã –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

### –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
1. ‚úÖ –õ–æ–≥–∏–∫–∞ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è XP —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ
2. ‚úÖ –õ–æ–≥–∏–∫–∞ SRS —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ
3. ‚ùå **–î–æ–±–∞–≤–∏—Ç—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –≤ UI** (–±–∞—Ç–∞—Ä–µ–π–∫–∞, —Ç–∞–π–º–µ—Ä, –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã)

### –ù–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:
1. –£–ø—Ä–æ—Å—Ç–∏—Ç—å —É—Å–ª–æ–≤–∏–µ –≤ —Å—Ç—Ä–æ–∫–µ 201 (—É–±—Ä–∞—Ç—å `stageAfter <= 0`)
2. –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
3. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–æ–≥–∏–∫–∏

## üéØ –ò—Ç–æ–≥:

**–û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ**, –Ω–æ **–æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è** –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –°–∏—Å—Ç–µ–º–∞ –Ω–∞—á–∏—Å–ª—è–µ—Ç XP –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤–∏–¥–∏—Ç:
- –°–∫–æ–ª—å–∫–æ —ç–Ω–µ—Ä–≥–∏–∏ –æ—Å—Ç–∞–ª–æ—Å—å
- –ö–æ–≥–¥–∞ —Å–ª–µ–¥—É—é—â–µ–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ
- –Ø–≤–ª—è–µ—Ç—Å—è –ª–∏ —Ç–µ–º–∞ "–≥–æ—Ä—è—á–µ–π"